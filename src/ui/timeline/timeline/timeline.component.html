<div class="timeline-container">
  <div class="playback-controls">
    <button
      class="playback-btn"
      (click)="togglePlayback()"
      [attr.aria-label]="isPlaying ? 'Pause' : 'Play'"
    >
      @if (isPlaying) {
        <span class="icon" aria-hidden="true">‚è∏</span>
      } @else {
        <span class="icon" aria-hidden="true">‚ñ∂</span>
      }
    </button>
    <button
      class="playback-btn stop-btn"
      (click)="stopPlayback()"
      aria-label="Stop"
      [disabled]="!isPlaying"
    >
      <span class="icon" aria-hidden="true">‚èπ</span>
    </button>
    <button
      class="playback-btn loop-btn"
      (click)="toggleLoop()"
      [attr.aria-label]="isLooping ? 'Disable loop' : 'Enable loop'"
      [class.active]="isLooping"
    >
      <span class="icon" aria-hidden="true">üîÅ</span>
    </button>
    <div class="frame-display">
      <span class="frame-label">Frame:</span>
      <span class="frame-counter">{{ currentFrame }} / {{ totalFrames }}</span>
    </div>
  </div>

  <div class="boards-track" role="listbox" aria-label="Board timeline">
    @for (board of store.boards(); track board.id) {
      <div
        class="board-card"
        [class.selected]="board.id === store.currentBoardId()"
        (click)="selectBoard(board.id)"
        (keydown.enter)="selectBoard(board.id)"
        (keydown.space)="$event.preventDefault(); selectBoard(board.id)"
        tabindex="0"
        role="option"
        [attr.aria-selected]="board.id === store.currentBoardId()"
        [attr.aria-label]="'Board ' + ($index + 1)"
      >
        @if (board.previewUrl) {
          <img class="board-preview" [src]="board.previewUrl" alt="" />
        } @else {
          <div class="board-preview"></div>
        }
        <span class="board-label">{{ $index + 1 }}</span>
        @if (store.boards().length > 1) {
          <button
            class="delete-btn"
            (click)="deleteBoard(board.id); $event.stopPropagation()"
            aria-label="Delete Board {{ $index + 1 }}"
          >
            <span aria-hidden="true">√ó</span>
          </button>
        }
        <div class="frame-duration">
          <label for="duration-{{ board.id }}">Duration:</label>
          <input
            id="duration-{{ board.id }}"
            type="number"
            min="0.1"
            step="0.1"
            inputmode="decimal"
            [value]="board.duration"
            (change)="updateFrameDuration(board.id, $any($event.target).value)"
          />
          <span class="duration-unit">s</span>
        </div>
      </div>
    }
    <button class="board-card add-card" (click)="addBoard()" aria-label="Add new board">
      <span class="add-icon" aria-hidden="true">+</span>
    </button>
  </div>
</div>
