<div class="timeline-editor custom-scrollbar" role="region" aria-label="Timeline Editor">
  <div #timelineContent class="timeline-content" [style.width.px]="totalWidth()">
    <div class="timeline-ruler" aria-hidden="true" (click)="onRulerClick($event)">
      @for (tick of rulerTicks(); track tick.time) {
        <div class="timeline-tick" [style.left.px]="tick.left">
          <span class="tick-label">{{ tick.label }}</span>
        </div>
      }
    </div>

    <div
      class="timeline-playhead"
      [style.left.px]="playheadPosition()"
      (mousedown)="startScrub($event)"
    >
      <div class="playhead-head"></div>
      <div class="playhead-line"></div>
    </div>

    <div class="timeline-tracks" role="listbox" aria-label="Timeline Boards">
      <div class="boards-track">
        @for (board of timelineBoards(); track board.id) {
          <div
            class="timeline-board"
            role="option"
            [attr.aria-selected]="store.currentBoardId() === board.id"
            [class.selected]="store.currentBoardId() === board.id"
            [class.resizing]="resizingBoardId() === board.id"
            [style.left.px]="board.leftPx"
            [style.width.px]="board.widthPx"
            (click)="selectBoard(board.id)"
            (keydown.enter)="selectBoard(board.id)"
            (keydown.space)="selectBoard(board.id)"
            tabindex="0"
          >
            @if ($index > 0) {
              <div
                class="resize-handle resize-handle-left"
                aria-label="Resize board {{ $index + 1 }} left edge"
                (mousedown)="startResize($event, board.id, 'left')"
              ></div>
            }

            <div
              class="resize-handle resize-handle-right"
              aria-label="Resize board {{ $index + 1 }} right edge"
              (mousedown)="startResize($event, board.id, 'right')"
            ></div>

            <div class="board-content">
              <div class="board-preview-container" [style.background]="board.backgroundColor">
                @if (board.previewUrl) {
                  <img [src]="board.previewUrl" alt="Board {{ $index + 1 }} preview" />
                }
              </div>
            </div>

            @if (store.boards().length > 1) {
              <button
                type="button"
                class="delete-btn"
                aria-label="Delete board {{ $index + 1 }}"
                (click)="$event.stopPropagation(); deleteBoard(board.id)"
              >
                <span aria-hidden="true">Ã—</span>
              </button>
            }
          </div>
        }

        <button
          type="button"
          class="add-board-btn"
          [style.left.px]="addButtonLeftPx()"
          aria-label="Add Board"
          (click)="addBoard()"
        >
          <span class="add-board-icon" aria-hidden="true">+</span>
        </button>
      </div>
    </div>
  </div>
</div>
